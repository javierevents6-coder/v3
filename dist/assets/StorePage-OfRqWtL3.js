const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CpkSNde8.js","assets/index-CsskAUoB.css"])))=>i.map(i=>d[i]);
import{r as l,u as V,b as U,d as m,q as W,o as H,g as J,j as e,e as y,h as u,T as E,_ as $,i as K}from"./index-CpkSNde8.js";import{A as D,P as A,O as L,C as I,a as M}from"./ContractsManagement-CivT8lc5.js";import{P as Q}from"./plus-DJX8Dt9Z.js";import"./package-DWaC_9ZF.js";import"./users-B_--4DUj.js";import"./clock-D3SJiViw.js";import"./check-circle-jwuhIQoi.js";import"./PackageEditorModal-svZSTvAg.js";import"./square-pen-9LV5eYLo.js";const ie=()=>{const[i,v]=l.useState([]),[k,O]=l.useState("todos"),f=new Set(["vestidos","vestido"]),[j,T]=l.useState(!1),[s,c]=l.useState("dashboard"),[w,N]=l.useState(!1),[C,h]=l.useState(null),[S,d]=l.useState(!1),{addToCart:z}=V();l.useEffect(()=>{n()},[]),l.useEffect(()=>{const t=r=>{const x=(r==null?void 0:r.detail)??!!localStorage.getItem("site_admin_mode");T(!!x)};return window.addEventListener("siteAdminModeChanged",t),window.addEventListener("storage",t),(async()=>{if(!(typeof navigator<"u"&&!navigator.onLine)&&i.length===0&&!localStorage.getItem("seeded_products"))try{const r=[{name:"Álbum Premium 30x30",description:"Álbum fotográfico de alta calidad con 30 páginas.",price:340,category:"album",image_url:"https://images.pexels.com/photos/18378220/pexels-photo-18378220.jpeg?auto=compress&cs=tinysrgb&w=1600",custom_text:"NUEVO"},{name:"Impresión Fine Art A3",description:"Papel algodón libre de ácido para máxima durabilidad.",price:80,category:"impresion",image_url:"https://images.pexels.com/photos/6795104/pexels-photo-6795104.jpeg?auto=compress&cs=tinysrgb&w=1600"},{name:"Marco de Madera 30x45",description:"Marco artesanal con vidrio antirreflejo.",price:120,category:"decoracion",image_url:"https://images.pexels.com/photos/2692555/pexels-photo-2692555.jpeg?auto=compress&cs=tinysrgb&w=1600"},{name:"USB Personalizado 32GB",description:"Entrega de fotos en USB grabado.",price:68,category:"acessorios",image_url:"https://images.pexels.com/photos/30332/pexels-photo.jpg?auto=compress&cs=tinysrgb&w=1600"},{name:"Poster 50x70",description:"Poster fotográfico premium listo para colgar.",price:90,category:"impresion",image_url:"https://images.pexels.com/photos/3184465/pexels-photo-3184465.jpeg?auto=compress&cs=tinysrgb&w=1600"}],{addDoc:x,collection:p}=await $(async()=>{const{addDoc:o,collection:b}=await import("./index-CpkSNde8.js").then(R=>R.V);return{addDoc:o,collection:b}},__vite__mapDeps([0,1])),{db:g}=await $(async()=>{const{db:o}=await import("./index-CpkSNde8.js").then(b=>b.W);return{db:o}},__vite__mapDeps([0,1]));await Promise.all(r.map(o=>x(p(g,"products"),{...o,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}))),localStorage.setItem("seeded_products","1"),n()}catch(r){console.warn("Seed products failed",r)}})(),()=>{window.removeEventListener("siteAdminModeChanged",t),window.removeEventListener("storage",t)}},[i.length]);const n=async()=>{try{if(typeof navigator<"u"&&!navigator.onLine){v([]);return}const t=U(m,"products");let a=t;try{a=W(t,H("created_at","desc"))}catch{a=t}const x=(await J(a)).docs.map(o=>({id:o.id,...o.data()})),p=new Set,g=[];for(const o of x){const b=`${String(o.name||"").trim().toLowerCase()}|${Number(o.price)||0}|${String(o.category||"").trim().toLowerCase()}`;p.has(b)||(p.add(b),g.push(o))}v(g)}catch{console.warn("Não foi possível carregar produtos no momento."),v([])}},q=["todos",...new Set(i.map(t=>t.category))].filter(t=>!f.has(String(t||"").toLowerCase())),F={todos:"Todos",equipamento:"Equipamentos",album:"Álbuns",acessorios:"Acessórios",decoracao:"Decoração"},B=k==="todos"?i.filter(t=>t.active!==!1&&!f.has(String(t.category||"").toLowerCase())):i.filter(t=>t.active!==!1&&!f.has(String(t.category||"").toLowerCase())&&t.category===k),G=t=>{const a=i.find(r=>r.id===t);a&&z({id:a.id,type:"store",name:a.name,price:`R$ ${a.price.toFixed(2).replace(".",",")}`,duration:"",image:a.image_url})},_=async(t,a)=>{try{await K(u(m,"products",t),{active:a,updated_at:new Date().toISOString()}),await n()}catch(r){console.error("Erro ao atualizar status do produto:",r),alert("No se pudo actualizar el estado")}},P=async t=>{if(confirm("Tem certeza de que deseja excluir este produto?"))try{await y(u(m,"products",t)),n()}catch(a){console.error("Erro ao excluir produto:",a),alert("Erro ao excluir o produto")}};return e.jsx("section",{className:"pt-32 pb-16",children:e.jsxs("div",{className:"container-custom",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsx("h1",{className:"section-title",children:"Tienda"}),e.jsx("div",{className:"flex items-center gap-4"})]}),j&&e.jsxs("div",{className:"mb-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>c("dashboard"),className:`px-4 py-2 rounded-none border-2 ${s==="dashboard"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Panel"}),e.jsx("button",{onClick:()=>c("products"),className:`px-4 py-2 rounded-none border-2 ${s==="products"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Productos"}),e.jsx("button",{onClick:()=>c("orders"),className:`px-4 py-2 rounded-none border-2 ${s==="orders"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Órdenes"}),e.jsx("button",{onClick:()=>c("contracts"),className:`px-4 py-2 rounded-none border-2 ${s==="contracts"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Contratos"}),e.jsx("button",{onClick:()=>c("packages"),className:`px-4 py-2 rounded-none border-2 ${s==="packages"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Paquetes"}),e.jsx("div",{className:"ml-auto",children:e.jsx("button",{onClick:()=>N(t=>!t),className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white",children:w?"Restaurar":"Maximizar"})})]}),s==="dashboard"&&e.jsx(D,{onNavigate:t=>c(t)}),s==="products"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"section-title",children:"Gestión de Productos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{if(!confirm("Buscar y eliminar productos duplicados por nombre y precio?"))return;const t=new Map;for(const a of i){const r=`${String(a.name||"").trim().toLowerCase()}|${Number(a.price)||0}|${String(a.category||"").trim().toLowerCase()}`;if(t.has(r))try{await y(u(m,"products",a.id))}catch{}else t.set(r,a.id)}n()},className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white transition-colors",children:"Eliminar Duplicados"}),e.jsx("button",{onClick:()=>{h(null),d(!0)},className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white transition-colors",children:"+ Agregar Producto"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(t=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden h-full flex flex-col",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{loading:"lazy",src:t.image_url,alt:t.name,className:"w-full h-44 object-cover"}),t.active===!1&&e.jsx("span",{className:"absolute top-2 left-2 text-xs px-2 py-1 rounded bg-gray-200 text-gray-700",children:"inactivo"})]}),e.jsxs("div",{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:"font-semibold",children:t.name}),e.jsxs("span",{className:"text-primary font-bold",children:["$",Number(t.price).toFixed(0)]})]}),e.jsx("p",{className:"text-gray-600 text-sm mt-1 line-clamp-2",children:t.description}),e.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-600",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded",children:t.category||"General"})}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 mt-auto",children:[e.jsx("button",{onClick:()=>{h(t),d(!0)},className:"flex-1 border-2 border-black text-black px-3 py-2 rounded-none hover:bg-black hover:text-white",children:"Editar"}),e.jsx("button",{onClick:()=>_(t.id,t.active===!1),className:`flex-1 border-2 border-black px-3 py-2 rounded-none ${t.active===!1?"bg-white text-black hover:bg-black hover:text-white":"bg-black text-white hover:opacity-90"}`,children:t.active===!1?"Activar":"Desactivar"}),e.jsx("button",{onClick:()=>P(t.id),className:"border-2 border-black text-black px-3 py-2 rounded hover:bg-black hover:text-white",children:e.jsx(E,{size:16})})]})]})]},t.id))}),e.jsx(A,{open:S,onClose:()=>d(!1),product:C,onSaved:n})]}),s==="orders"&&e.jsx(L,{}),s==="contracts"&&e.jsx(I,{}),s==="packages"&&e.jsx(M,{})]}),j&&w&&e.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("button",{onClick:()=>c("dashboard"),className:`px-4 py-2 rounded-none border-2 ${s==="dashboard"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Panel"}),e.jsx("button",{onClick:()=>c("products"),className:`px-4 py-2 rounded-none border-2 ${s==="products"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Productos"}),e.jsx("button",{onClick:()=>c("orders"),className:`px-4 py-2 rounded-none border-2 ${s==="orders"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Órdenes"}),e.jsx("button",{onClick:()=>c("contracts"),className:`px-4 py-2 rounded-none border-2 ${s==="contracts"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Contratos"}),e.jsx("button",{onClick:()=>c("packages"),className:`px-4 py-2 rounded-none border-2 ${s==="packages"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Paquetes"}),e.jsx("div",{className:"ml-auto",children:e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white",children:"Cerrar pantalla completa"})})]}),s==="dashboard"&&e.jsx(D,{onNavigate:t=>c(t)}),s==="products"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"section-title",children:"Gestión de Productos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{if(!confirm("Buscar y eliminar productos duplicados por nombre y precio?"))return;const t=new Map;for(const a of i){const r=`${String(a.name||"").trim().toLowerCase()}|${Number(a.price)||0}|${String(a.category||"").trim().toLowerCase()}`;if(t.has(r))try{await y(u(m,"products",a.id))}catch{}else t.set(r,a.id)}n()},className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white transition-colors",children:"Eliminar Duplicados"}),e.jsx("button",{onClick:()=>{h(null),d(!0)},className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white transition-colors",children:"+ Agregar Producto"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:i.map(t=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden h-full flex flex-col",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{loading:"lazy",src:t.image_url,alt:t.name,className:"w-full h-44 object-cover"}),t.active===!1&&e.jsx("span",{className:"absolute top-2 left-2 text-xs px-2 py-1 rounded bg-gray-200 text-gray-700",children:"inactivo"})]}),e.jsxs("div",{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:"font-semibold",children:t.name}),e.jsxs("span",{className:"text-primary font-bold",children:["$",Number(t.price).toFixed(0)]})]}),e.jsx("p",{className:"text-gray-600 text-sm mt-1 line-clamp-2",children:t.description}),e.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-600",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded",children:t.category||"General"})}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 mt-auto",children:[e.jsx("button",{onClick:()=>{h(t),d(!0)},className:"flex-1 border-2 border-black text-black px-3 py-2 rounded-none hover:bg-black hover:text-white",children:"Editar"}),e.jsx("button",{onClick:()=>_(t.id,t.active===!1),className:`flex-1 border-2 border-black px-3 py-2 rounded-none ${t.active===!1?"bg-white text-black hover:bg-black hover:text-white":"bg-black text-white hover:opacity-90"}`,children:t.active===!1?"Activar":"Desactivar"}),e.jsx("button",{onClick:()=>P(t.id),className:"border-2 border-black text-black px-3 py-2 rounded hover:bg-black hover:text-white",children:e.jsx(E,{size:16})})]})]})]},t.id))}),e.jsx(A,{open:S,onClose:()=>d(!1),product:C,onSaved:n})]}),s==="orders"&&e.jsx(L,{}),s==="contracts"&&e.jsx(I,{}),s==="packages"&&e.jsx(M,{})]})}),!j&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex flex-wrap gap-4 mb-8",children:q.map(t=>e.jsx("button",{onClick:()=>O(t),className:`px-4 py-2 rounded-none border-2 ${k===t?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:F[t]||t},t))}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-6",children:B.map(t=>e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:t.image_url,alt:t.name,className:"w-full h-48 object-cover"}),t.custom_text&&e.jsx("div",{className:"absolute top-2 left-2 bg-black bg-opacity-70 text-white px-2 py-1 rounded text-xs",children:t.custom_text}),e.jsx("div",{className:"absolute top-2 left-2 bg-primary bg-opacity-80 text-white px-2 py-1 rounded text-xs",children:"FOTO"})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:t.name}),e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:t.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-xl font-playfair text-primary",children:["R$ ",t.price.toFixed(2)]}),e.jsx("button",{onClick:()=>G(t.id),className:"bg-primary text-white p-2 rounded-full hover:bg-opacity-90",children:e.jsx(Q,{size:20})})]})]})]},t.id))})]})]})})};export{ie as default};
