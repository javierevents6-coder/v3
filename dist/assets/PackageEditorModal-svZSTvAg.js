import{r as a,j as e,X as A,T as B,l as F}from"./index-CpkSNde8.js";import{P as U}from"./plus-DJX8Dt9Z.js";const X=({open:I,onClose:o,pkg:s,onSaved:m})=>{const[b,p]=a.useState(""),[h,j]=a.useState(0),[g,v]=a.useState(""),[y,f]=a.useState(""),[N,S]=a.useState(""),[w,C]=a.useState(""),[E,P]=a.useState(""),[l,d]=a.useState([]),[_,u]=a.useState(!1),[z,n]=a.useState(""),[i,c]=a.useState(""),[T,k]=a.useState(!1),[D,R]=a.useState(null);a.useEffect(()=>{if(!s)return;p(s.title||""),j(Number(s.price)||0),v(s.duration||""),f(s.description||""),S((s.features||[]).join(`
`)),C(s.image_url||""),P(s.category||"");const t=Array.isArray(s.sections)?s.sections.slice():[];d(t),c(t[0]||"")},[s]);const $=async()=>{if(s)try{k(!0),R(null);const t={title:b,price:Number(h)||0,duration:g,description:y,features:N.split(`
`).map(x=>x.trim()).filter(Boolean),image_url:w,category:E||void 0};t.sections=l,await F(s.id,t);const r={...s,...t,sections:l};m&&m(r),o()}catch(t){R((t==null?void 0:t.message)||"Erro ao salvar pacote")}finally{k(!1)}};return!I||!s?null:e.jsx("div",{className:"fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white p-4 border-b flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Editar pacote"}),e.jsx("button",{onClick:o,className:"text-gray-500 hover:text-gray-700",children:e.jsx(A,{size:20})})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[D&&e.jsx("div",{className:"p-3 rounded border border-red-200 bg-red-50 text-red-700 text-sm",children:D}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Título"}),e.jsx("input",{value:b,onChange:t=>p(t.target.value),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Preço (R$)"}),e.jsx("input",{type:"number",step:"0.01",value:h,onChange:t=>j(Number(t.target.value)),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Duração"}),e.jsx("input",{value:g,onChange:t=>v(t.target.value),className:"w-full px-3 py-2 border rounded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Descrição"}),e.jsx("textarea",{value:y,onChange:t=>f(t.target.value),rows:3,className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Recursos (um por linha)"}),e.jsx("textarea",{value:N,onChange:t=>S(t.target.value),rows:5,className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Imagem (URL)"}),e.jsx("input",{value:w,onChange:t=>C(t.target.value),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Categoria (opcional)"}),e.jsx("input",{value:E||"",onChange:t=>P(t.target.value),className:"w-full px-3 py-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-700 mb-1",children:"Sección"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("select",{value:i||"",onChange:t=>c(t.target.value),className:"px-3 py-2 border rounded flex-1",children:[e.jsx("option",{value:"",children:"Sin sección"}),l.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("button",{type:"button",title:"Agregar",onClick:()=>{u(!0),n("")},className:"p-2 border rounded text-gray-600",children:e.jsx(U,{size:14})}),e.jsx("button",{type:"button",title:"Eliminar sección",onClick:()=>{if(!i)return alert("Selecciona una sección para eliminar");confirm(`Eliminar la sección "${i}"?`)&&(d(t=>t.filter(r=>r!==i)),c(t=>l.filter(x=>x!==(t||""))[0]||""))},className:"p-2 border rounded text-gray-600",children:e.jsx(B,{size:14})})]}),_&&e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx("input",{value:z,onChange:t=>n(t.target.value),className:"px-3 py-2 border rounded-md flex-1",placeholder:"Nueva sección"}),e.jsx("button",{type:"button",onClick:()=>{const t=(z||"").trim();t&&(l.includes(t)||d(r=>[...r,t]),c(t),u(!1),n(""))},className:"p-2 bg-primary text-white rounded",children:e.jsx(U,{size:14})}),e.jsx("button",{type:"button",onClick:()=>{u(!1),n("")},className:"p-2 border rounded text-gray-600",children:e.jsx(A,{size:14})})]})]})]}),e.jsxs("div",{className:"border-t p-4 flex justify-end gap-2",children:[e.jsx("button",{onClick:o,className:"px-4 py-2 rounded border",children:"Cancelar"}),e.jsx("button",{onClick:$,disabled:T,className:"px-4 py-2 rounded bg-primary text-white disabled:opacity-50",children:T?"Salvando...":"Salvar"})]})]})})};export{X as P};
