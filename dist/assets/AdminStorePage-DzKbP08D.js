import{k as L,r as o,j as e,e as f,h as j,d as u,T as S,b as T,q as z,o as O,g as q,i as B}from"./index-CpkSNde8.js";import{A as E,P,O as $,C as A,a as _}from"./ContractsManagement-CivT8lc5.js";import"./plus-DJX8Dt9Z.js";import"./package-DWaC_9ZF.js";import"./users-B_--4DUj.js";import"./clock-D3SJiViw.js";import"./check-circle-jwuhIQoi.js";import"./PackageEditorModal-svZSTvAg.js";import"./square-pen-9LV5eYLo.js";const M="mp_access_token",N=()=>{var p,g;const{flags:t,setPageEnabled:r,setPaymentEnabled:k}=L(),[v,d]=o.useState(!!(((p=t.payments)==null?void 0:p.mpEnabled)??!0)),[b,h]=o.useState(""),[x,m]=o.useState("none");o.useEffect(()=>{const a=typeof window<"u"?localStorage.getItem(M):"";h(a||"")},[]),o.useEffect(()=>{var a;d(!!(((a=t.payments)==null?void 0:a.mpEnabled)??!0))},[(g=t.payments)==null?void 0:g.mpEnabled]);const n=o.useMemo(()=>Object.entries(t.pages),[t.pages]),l=()=>{try{localStorage.setItem(M,b.trim()),m("ok"),setTimeout(()=>m("none"),1500)}catch{}};return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"section-title",children:"Ajustes da Loja"}),e.jsx("p",{className:"text-gray-600",children:"Configure a visibilidade de páginas e opções de pagamento."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Visibilidade de Páginas"}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Habilite ou desabilite páginas para ocultá-las do site."}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:n.map(([a,s])=>e.jsxs("label",{className:"flex items-center gap-3 border rounded-lg p-2",children:[e.jsx("input",{type:"checkbox",checked:!!s,onChange:c=>r(a,c.target.checked)}),e.jsx("span",{className:"capitalize text-sm",children:a.replace(/([A-Z])/g," $1").replace(/\s+/g," ").trim()})]},a))})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-4",children:[e.jsx("h3",{className:"font-medium mb-3",children:"Pagamentos"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("label",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:async a=>{d(a.target.checked),await k(a.target.checked)}}),e.jsx("span",{className:"text-sm",children:"Ativar pagamento com Mercado Pago"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Access Token (MP_ACCESS_TOKEN)"}),e.jsx("input",{type:"password",value:b,onChange:a=>h(a.target.value),className:"w-full border border-gray-300 rounded px-3 py-2",placeholder:"APP_USR-..."}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white",children:"Salvar"}),x==="ok"&&e.jsx("span",{className:"text-green-600 text-sm self-center",children:"Salvo"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Este token é salvo apenas no seu navegador para uso administrativo. Em produção, configure as variáveis no provedor (Netlify)."})]})]})]})]})]})},Z=()=>{const[t,r]=o.useState("dashboard"),[k,v]=o.useState(!1),[d,b]=o.useState([]),[h,x]=o.useState(null),[m,n]=o.useState(!1),l=async()=>{try{if(typeof navigator<"u"&&!navigator.onLine){b([]);return}const a=T(u,"products");let s=a;try{s=z(a,O("created_at","desc"))}catch{s=a}const D=(await q(s)).docs.map(i=>({id:i.id,...i.data()})),y=new Set,w=[];for(const i of D){const C=`${String(i.name||"").trim().toLowerCase()}|${Number(i.price)||0}|${String(i.category||"").trim().toLowerCase()}`;y.has(C)||(y.add(C),w.push(i))}b(w)}catch{console.warn("Não foi possível carregar produtos no momento."),b([])}};o.useEffect(()=>{l()},[]);const p=async(a,s)=>{try{await B(j(u,"products",a),{active:s,updated_at:new Date().toISOString()}),await l()}catch(c){console.error("Erro ao atualizar status do produto:",c),alert("No se pudo actualizar el estado")}},g=async a=>{if(confirm("Tem certeza de que deseja excluir este produto?"))try{await f(j(u,"products",a)),l()}catch(s){console.error("Erro ao excluir produto:",s),alert("Erro ao excluir o produto")}};return e.jsx("section",{className:"pt-32 pb-16",children:e.jsxs("div",{className:"container-custom",children:[e.jsxs("div",{className:"mb-8 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>r("dashboard"),className:`px-4 py-2 rounded-none border-2 ${t==="dashboard"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Panel"}),e.jsx("button",{onClick:()=>r("products"),className:`px-4 py-2 rounded-none border-2 ${t==="products"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Productos"}),e.jsx("button",{onClick:()=>r("orders"),className:`px-4 py-2 rounded-none border-2 ${t==="orders"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Órdenes"}),e.jsx("button",{onClick:()=>r("contracts"),className:`px-4 py-2 rounded-none border-2 ${t==="contracts"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Contratos"}),e.jsx("button",{onClick:()=>r("packages"),className:`px-4 py-2 rounded-none border-2 ${t==="packages"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Paquetes"}),e.jsx("button",{onClick:()=>r("settings"),className:`px-4 py-2 rounded-none border-2 ${t==="settings"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Ajustes"}),e.jsx("div",{className:"ml-auto",children:e.jsx("button",{onClick:()=>v(a=>!a),className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white",children:k?"Restaurar":"Maximizar"})})]}),t==="dashboard"&&e.jsx(E,{onNavigate:a=>r(a)}),t==="products"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"section-title",children:"Gestión de Productos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{if(!confirm("Buscar y eliminar productos duplicados por nombre y precio?"))return;const a=new Map;for(const s of d){const c=`${String(s.name||"").trim().toLowerCase()}|${Number(s.price)||0}|${String(s.category||"").trim().toLowerCase()}`;if(a.has(c))try{await f(j(u,"products",s.id))}catch{}else a.set(c,s.id)}l()},className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white transition-colors",children:"Eliminar Duplicados"}),e.jsx("button",{onClick:()=>{x(null),n(!0)},className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white transition-colors",children:"+ Agregar Producto"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(a=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden h-full flex flex-col",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{loading:"lazy",src:a.image_url,alt:a.name,className:"w-full h-44 object-cover"}),a.active===!1&&e.jsx("span",{className:"absolute top-2 left-2 text-xs px-2 py-1 rounded bg-gray-200 text-gray-700",children:"inactivo"})]}),e.jsxs("div",{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:"font-semibold",children:a.name}),e.jsxs("span",{className:"text-primary font-bold",children:["$",Number(a.price).toFixed(0)]})]}),e.jsx("p",{className:"text-gray-600 text-sm mt-1 line-clamp-2",children:a.description}),e.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-600",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded",children:a.category||"General"})}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 mt-auto",children:[e.jsx("button",{onClick:()=>{x(a),n(!0)},className:"flex-1 border-2 border-black text-black px-3 py-2 rounded-none hover:bg-black hover:text-white",children:"Editar"}),e.jsx("button",{onClick:()=>p(a.id,a.active===!1),className:`flex-1 border-2 border-black px-3 py-2 rounded-none ${a.active===!1?"bg-white text-black hover:bg-black hover:text-white":"bg-black text-white hover:opacity-90"}`,children:a.active===!1?"Activar":"Desactivar"}),e.jsx("button",{onClick:()=>g(a.id),className:"border-2 border-black text-black px-3 py-2 rounded hover:bg-black hover:text-white",children:e.jsx(S,{size:16})})]})]})]},a.id))}),e.jsx(P,{open:m,onClose:()=>n(!1),product:h,onSaved:l})]}),t==="orders"&&e.jsx($,{}),t==="contracts"&&e.jsx(A,{}),t==="packages"&&e.jsx(_,{}),t==="settings"&&e.jsx(N,{})]}),k&&e.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-auto p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("button",{onClick:()=>r("dashboard"),className:`px-4 py-2 rounded-none border-2 ${t==="dashboard"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Panel"}),e.jsx("button",{onClick:()=>r("products"),className:`px-4 py-2 rounded-none border-2 ${t==="products"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Productos"}),e.jsx("button",{onClick:()=>r("orders"),className:`px-4 py-2 rounded-none border-2 ${t==="orders"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Órdenes"}),e.jsx("button",{onClick:()=>r("contracts"),className:`px-4 py-2 rounded-none border-2 ${t==="contracts"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Contratos"}),e.jsx("button",{onClick:()=>r("packages"),className:`px-4 py-2 rounded-none border-2 ${t==="packages"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Paquetes"}),e.jsx("button",{onClick:()=>r("settings"),className:`px-4 py-2 rounded-none border-2 ${t==="settings"?"bg-black text-white border-black":"border-black text-black hover:bg-black hover:text-white"}`,children:"Ajustes"}),e.jsx("div",{className:"ml-auto",children:e.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white",children:"Cerrar pantalla completa"})})]}),t==="dashboard"&&e.jsx(E,{onNavigate:a=>r(a)}),t==="products"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"section-title",children:"Gestión de Productos"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:async()=>{if(!confirm("Buscar y eliminar productos duplicados por nombre y precio?"))return;const a=new Map;for(const s of d){const c=`${String(s.name||"").trim().toLowerCase()}|${Number(s.price)||0}|${String(s.category||"").trim().toLowerCase()}`;if(a.has(c))try{await f(j(u,"products",s.id))}catch{}else a.set(c,s.id)}l()},className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white transition-colors",children:"Eliminar Duplicados"}),e.jsx("button",{onClick:()=>{x(null),n(!0)},className:"px-4 py-2 rounded-none border-2 border-black text-black hover:bg-black hover:text-white transition-colors",children:"+ Agregar Producto"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:d.map(a=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 overflow-hidden h-full flex flex-col",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{loading:"lazy",src:a.image_url,alt:a.name,className:"w-full h-44 object-cover"}),a.active===!1&&e.jsx("span",{className:"absolute top-2 left-2 text-xs px-2 py-1 rounded bg-gray-200 text-gray-700",children:"inactivo"})]}),e.jsxs("div",{className:"p-4 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsx("h3",{className:"font-semibold",children:a.name}),e.jsxs("span",{className:"text-primary font-bold",children:["$",Number(a.price).toFixed(0)]})]}),e.jsx("p",{className:"text-gray-600 text-sm mt-1 line-clamp-2",children:a.description}),e.jsx("div",{className:"mt-3 flex items-center gap-2 text-xs text-gray-600",children:e.jsx("span",{className:"px-2 py-1 bg-gray-100 rounded",children:a.category||"General"})}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 mt-auto",children:[e.jsx("button",{onClick:()=>{x(a),n(!0)},className:"flex-1 border-2 border-black text-black px-3 py-2 rounded-none hover:bg-black hover:text-white",children:"Editar"}),e.jsx("button",{onClick:()=>p(a.id,a.active===!1),className:`flex-1 border-2 border-black px-3 py-2 rounded-none ${a.active===!1?"bg-white text-black hover:bg-black hover:text-white":"bg-black text-white hover:opacity-90"}`,children:a.active===!1?"Activar":"Desactivar"}),e.jsx("button",{onClick:()=>g(a.id),className:"border-2 border-black text-black px-3 py-2 rounded hover:bg-black hover:text-white",children:e.jsx(S,{size:16})})]})]})]},a.id))}),e.jsx(P,{open:m,onClose:()=>n(!1),product:h,onSaved:l})]}),t==="orders"&&e.jsx($,{}),t==="contracts"&&e.jsx(A,{}),t==="packages"&&e.jsx(_,{}),t==="settings"&&e.jsx(N,{}),t==="settings"&&e.jsx(N,{})]})})]})})};export{Z as default};
